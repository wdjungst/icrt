// Generated by CoffeeScript 1.4.0
(function() {

  $(function() {
    var postRooms;
    $('.map').maphilight();
    postRooms = function(rooms) {
      return $.each(rooms, function(i, l) {
        return $.ajax({
          type: "POST",
          url: '/room',
          data: "room=" + ($(l).attr('id')) + "&time=" + ($('#time_select').val()),
          success: function(data) {
            if (data === 'true') {
              return $(l).attr('data-maphilight', '{"fillColor":"228B22","fillOpacity":"0.6", "alwaysOn":true}').trigger("alwaysOn.maphilight");
            } else {
              return $(l).attr('data-maphilight', '{"fillColor":"FFFFFF","fillOpacity":"1.0", "alwaysOn":true}').trigger("alwaysOn.maphilight");
            }
          },
          error: function(data) {
            console.log('fail');
            return alert(data);
          }
        });
      });
    };
    postRooms($('.room'));
    $('area').bind('click', function(e) {
      return e.preventDefault();
    });
    return $('#time_select').bind('change', function() {
      $('.room').data("maphilight", {
        alwaysOn: false
      }).trigger("alwaysOn.maphilight");
      return postRooms($('.room'));
    });
  });

}).call(this);
